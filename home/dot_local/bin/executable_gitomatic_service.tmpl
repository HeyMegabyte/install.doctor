#!/usr/bin/env bash

# @file .local/bin/gitomatic_service
# @brief Helper script to run gitomatic to monitor git repositories
# @description
#   This script is executed by gitomatic systemd service. `gitomatic` does not support monitoring multiple
#   repositories in a single process. This script starts as many gitomatic processes as there are repositories.
#
#   ## Links
#
#   [Systemd Unit file](https://github.com/megabyte-labs/install.doctor/blob/master/home/dot_config/gitomatic/gitomatic.service.tmpl)

{{ includeTemplate "universal/logg" }}

{{ range .data.user.gitomatic }}
gitomatic -author {{ $.data.user.name }} -email {{ $.data.user.email }} -privkey {{ $.chezmoi.homeDir }}/.ssh/id_rsa {{ .path }} &
{{ end -}}
