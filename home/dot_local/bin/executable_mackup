{{- if ne .host.distro.family "windows" -}}
#!/usr/bin/env bash
# @file ~/.local/bin/mackup
# @brief Creates a wrapper around `mackup` to add support for XDG directories
# @description
#   This script is a wrapper around the `mackup`. `Mackup` does not support XDG specification
#   for its configuration. The script symlinks the `.config/mackup/.mackup/` folder to `~/.mackup` and
#   the `.config/mackup/.mackup.cfg` file to `~/.mackup.cfg` before executing `mackup`. It deletes the
#   symlinks after mackup runs.

{{ includeTemplate "universal/profile" }}
{{ includeTemplate "universal/logg" }}

{{- if eq .host.distro.family "linux" -}}
ln -s "${XDG_CONFIG_HOME:-$HOME/.config}/mackup/.mackup/" ~/.mackup
ln -s "${XDG_CONFIG_HOME:-$HOME/.config}/mackup/.mackup.cfg" ~/.mackup.cfg
# TODO Determine the path based on the installation method
/home/linuxbrew/.linuxbrew/bin/mackup "$@" || echo ''
{{ end }}
{{- if (eq .host.distro.family "darwin") -}}
# TODO Add logic for MacOS
{{ end }}
rm -f ~/.mackup
rm -f ~/.mackup.cfg
{{ end }}
