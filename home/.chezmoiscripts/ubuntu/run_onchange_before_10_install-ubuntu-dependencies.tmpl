#!/usr/bin/env bash

# universal/essential-packages hash: {{ include (joinPath ".chezmoitemplates" "universal" "essential-packages") | sha256sum }}

{{ includeTemplate "universal/logg" }}

{{- $packages := splitList " " (includeTemplate "universal/essential-packages" .) -}}
{{- $gpgDependencies := list
"gnupg2"
"gnupg-agent"
"gnupg-curl"
"scdaemon"
"pcscd"
-}}
{{- $packages = concat $packages $gpgDependencies -}}

logg 'Installing common dependencies using `apt-get`'
logg info 'Dependencies: {{ $packages | sortAlpha | uniq | join " " -}}'

sudo apt-get update
echo {{ $packages | sortAlpha | uniq | join " " -}} | xargs -n 1 sudo apt-get install -y --no-install-recommends
